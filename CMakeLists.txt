cmake_minimum_required(VERSION 3.16)
project(
    KSyntaxHighlighting
    VERSION 6.7.0
    LANGUAGES C CXX)

set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)
set(CMAKE_AUTOUIC ON)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

set(CMAKE_INCLUDE_CURRENT_DIR ON)

find_package(QT NAMES Qt6 Qt5 REQUIRED COMPONENTS Core Gui Network)
find_package(Qt${QT_VERSION_MAJOR} REQUIRED COMPONENTS Core Gui Network)

if(MSVC)
    string(APPEND CMAKE_CXX_FLAGS " /utf-8")
    string(APPEND CMAKE_C_FLAGS " /utf-8")
endif()

add_library(
    KSyntaxHighlighting
    autogenerated/src/lib/ksyntaxhighlighting_logging.cpp
    autogenerated/src/lib/ksyntaxhighlighting_logging.h
    autogenerated/ksyntaxhighlighting_version.h
    autogenerated/src/lib/ksyntaxhighlighting_export.h
    data/themes/theme-data.qrc
    src/lib/abstracthighlighter.cpp
    src/lib/abstracthighlighter.h
    src/lib/abstracthighlighter_p.h
    src/lib/context.cpp
    src/lib/context_p.h
    src/lib/contextswitch.cpp
    src/lib/contextswitch_p.h
    src/lib/definition.cpp
    src/lib/definition.h
    src/lib/definitiondownloader.cpp
    src/lib/definitiondownloader.h
    src/lib/definition_p.h
    src/lib/dynamicregexpcache_p.h
    src/lib/foldingregion.cpp
    src/lib/foldingregion.h
    src/lib/format.cpp
    src/lib/format.h
    src/lib/format_p.h
    src/lib/htmlhighlighter.cpp
    src/lib/htmlhighlighter.h
    src/lib/highlightingdata.cpp
    src/lib/highlightingdata_p.hpp
    src/lib/keywordlist.cpp
    src/lib/keywordlist_p.h
    src/lib/matchresult_p.h
    src/lib/repository.cpp
    src/lib/repository.h
    src/lib/repository_p.h
    src/lib/rule.cpp
    src/lib/rule_p.h
    src/lib/state.cpp
    src/lib/state.h
    src/lib/state_p.h
    src/lib/syntaxhighlighter.cpp
    src/lib/syntaxhighlighter.h
    src/lib/textstyledata_p.h
    src/lib/theme.cpp
    src/lib/theme.h
    src/lib/themedata.cpp
    src/lib/themedata_p.h
    src/lib/wildcardmatcher.cpp
    src/lib/worddelimiters.cpp
    src/lib/worddelimiters_p.h
    src/lib/xml_p.h)

target_include_directories(
    KSyntaxHighlighting PUBLIC autogenerated src/lib autogenerated/include
                               autogenerated/src/lib)

target_compile_definitions(KSyntaxHighlighting
                           PUBLIC KSYNTAXHIGHLIGHTING_STATIC_DEFINE)

target_link_libraries(
    KSyntaxHighlighting
    PUBLIC Qt${QT_VERSION_MAJOR}::Core Qt${QT_VERSION_MAJOR}::Gui
           Qt${QT_VERSION_MAJOR}::Network)
